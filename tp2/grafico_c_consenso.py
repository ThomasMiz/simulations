import matplotlib.pyplot as plt

# Datos: 100 puntos equidistantes
#p = [0,0.01,0.02,0.03,0.04,0.049999997,0.06,0.07,0.08,0.089999996,0.099999994,0.11,0.12,0.13,0.14,0.14999999,0.16,0.17,0.17999999,0.19,0.19999999,0.21,0.22,0.22999999,0.24,0.25,0.26,0.26999998,0.28,0.29,0.29999998,0.31,0.32,0.32999998,0.34,0.35,0.35999998,0.37,0.38,0.39,0.39999998,0.41,0.42,0.42999998,0.44,0.45,0.45999998,0.47,0.48,0.48999998,0.5,0.51,0.52,0.53,0.53999996,0.55,0.56,0.57,0.58,0.59,0.59999996,0.61,0.62,0.63,0.64,0.65,0.65999997,0.66999996,0.68,0.69,0.7,0.71,0.71999997,0.72999996,0.74,0.75,0.76,0.77,0.78,0.78999996,0.79999995,0.81,0.82,0.83,0.84,0.84999996,0.85999995,0.87,0.88,0.89,0.9,0.90999997,0.91999996,0.93,0.94,0.95,0.96,0.96999997,0.97999996,0.98999995]
#consensus = [0.0432,0.9799352,0.9593196,0.937416,0.9135528,0.885982,0.8525524,0.8032096,0.6828868,0.4700276,0.0979064,0.091354,0.0925556,0.061956,0.0547392,0.0453202,0.0415844,0.0419896,0.0377704,0.0372956,0.0342612,0.0312836,0.0334352,0.0283908,0.0294092,0.0267228,0.0251352,0.025508,0.0245444,0.0236196,0.0237542,0.023236,0.0223742,0.0210528,0.0208324,0.0214968,0.020836,0.0192614,0.0198284,0.019184,0.0185812,0.0186492,0.01773,0.0176524,0.0178396,0.0172872,0.0173156,0.0165836,0.0161764,0.0163368,0.0157904,0.0160486,0.015424,0.0150544,0.0150028,0.0152788,0.0149368,0.0143624,0.0139758,0.013965,0.013864,0.0137566,0.0136758,0.012788,0.0135036,0.013034,0.0127792,0.0122384,0.0123928,0.0122628,0.011984,0.011634,0.011546,0.01131,0.0114432,0.0111756,0.011048,0.0110384,0.0108448,0.0108352,0.010201,0.010424,0.0099596,0.0098308,0.0096248,0.0094912,0.0095504,0.0090692,0.008897,0.0085828,0.0085612,0.0081688,0.007901,0.0073852,0.0069504,0.0063646,0.0057576,0.0050248,0.0041176,0.0033164]

# Datos: 200 puntos entre 0 y 0.2
#p = [0,0.001,0.002,0.003,0.004,0.0050000004,0.006,0.007,0.008,0.009000001,0.010000001,0.011000001,0.012,0.013,0.014,0.015000001,0.016,0.017,0.018000001,0.019000001,0.020000001,0.021000002,0.022000002,0.023000002,0.024,0.025,0.026,0.027,0.028,0.029000001,0.030000001,0.031000001,0.032,0.033,0.034,0.035,0.036000002,0.037,0.038000003,0.039,0.040000003,0.041,0.042000003,0.043,0.044000003,0.045,0.046000004,0.047000002,0.048,0.049000002,0.05,0.051000003,0.052,0.053000003,0.054,0.055000003,0.056,0.057000004,0.058000002,0.059000004,0.060000002,0.061000004,0.062000003,0.063,0.064,0.065000005,0.066,0.067,0.068,0.069000006,0.07,0.071,0.072000004,0.07300001,0.074,0.075,0.076000005,0.07700001,0.078,0.079,0.080000006,0.081,0.082,0.083000004,0.08400001,0.085,0.086,0.087000005,0.08800001,0.089,0.09,0.091000006,0.09200001,0.093,0.094000004,0.095000006,0.096,0.097,0.098000005,0.09900001,0.1,0.101,0.102000006,0.10300001,0.104,0.105000004,0.106000006,0.10700001,0.108,0.109000005,0.11000001,0.11100001,0.112,0.113000005,0.11400001,0.115,0.116000004,0.117000006,0.11800001,0.119,0.120000005,0.12100001,0.12200001,0.123,0.124000005,0.125,0.126,0.127,0.128,0.12900001,0.13000001,0.13100001,0.132,0.133,0.134,0.135,0.136,0.13700001,0.13800001,0.13900001,0.14,0.141,0.142,0.143,0.14400001,0.14500001,0.14600001,0.147,0.148,0.149,0.15,0.15100001,0.15200001,0.15300001,0.15400001,0.155,0.156,0.157,0.158,0.15900001,0.16000001,0.16100001,0.162,0.163,0.164,0.165,0.16600001,0.16700001,0.16800001,0.16900001,0.17,0.171,0.172,0.17300001,0.17400001,0.17500001,0.17600001,0.177,0.178,0.179,0.18,0.18100001,0.18200001,0.18300001,0.18400002,0.185,0.186,0.187,0.18800001,0.18900001,0.19000001,0.19100001,0.192,0.193,0.194,0.19500001,0.19600001,0.19700001,0.19800001,0.19900002]
#consensus = [0.0432,0.0148604,0.0089868,0.1355776,0.6107688,0.2421784,0.3528244,0.2813188,0.9838716,0.981894,0.9799352,0.977794,0.9757084,0.1265468,0.9715964,0.969572,0.2710264,0.1596784,0.2096844,0.9613784,0.9593196,0.177568,0.115222,0.2854124,0.9505268,0.9484252,0.946128,0.480212,0.9418148,0.9398336,0.937416,0.0909288,0.93279,0.0476324,0.92809397,0.0850476,0.2145296,0.9206084,0.918438,0.9163212,0.9135528,0.2596424,0.1661988,0.906146,0.9032636,0.183734,0.8981776,0.8956984,0.3187148,0.8899732,0.885982,0.8832672,0.8800592,0.0592424,0.873914,0.869062,0.8656296,0.8629524,0.8600724,0.855526,0.8525524,0.848838,0.8452632,0.839378,0.8349996,0.8329052,0.824948,0.8228728,0.8130268,0.8122852,0.8032096,0.8019716,0.7920508,0.7883698,0.7808592,0.7693376,0.7661064,0.7199428,0.7389928,0.7287368,0.6828868,0.6456904,0.69919163,0.6907212,0.651654,0.6655308,0.495862,0.5328852,0.4168072,0.2342636,0.4700276,0.2054812,0.5086656,0.4002552,0.2835856,0.3059426,0.2862692,0.3177732,0.1121852,0.1229608,0.0979064,0.151706,0.1001438,0.134196,0.1612128,0.0713888,0.0904764,0.110812,0.1124788,0.1084564,0.091354,0.0584952,0.0843624,0.0877432,0.0767564,0.0793148,0.112178,0.0659788,0.1021812,0.0746196,0.0925556,0.061952,0.0620348,0.0694324,0.0705408,0.0581076,0.0636196,0.0663876,0.067626,0.0487688,0.061956,0.0541132,0.0527976,0.0608764,0.066714,0.0564916,0.0695632,0.0594836,0.0653444,0.057112,0.0547392,0.0477012,0.0657808,0.0456984,0.0570536,0.0468876,0.0540212,0.0538532,0.051854,0.0436964,0.0469248,0.0478452,0.0496706,0.0425308,0.0524924,0.0447468,0.0473352,0.0471112,0.0456572,0.0389344,0.0415844,0.042702,0.0405376,0.0385696,0.0417112,0.0412958,0.0409756,0.04138,0.0434488,0.038132,0.0419896,0.0390464,0.0374412,0.0439928,0.0390372,0.037032,0.0405076,0.0379204,0.0382884,0.0406444,0.0377704,0.03695,0.0359208,0.0359532,0.0375712,0.0363976,0.0351328,0.036751,0.0332708,0.034766,0.0372956,0.0361484,0.0336804,0.0355064,0.032092,0.0377064,0.0367356,0.0350068,0.03087,0.0354316]

# Datos: varios puntos entre 0 y 1 mayor distribución en p crítico
#p = [0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.085,0.09,0.095,0.1,0.105,0.15,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1]
#consensus = [0.9799203,0.95953494,0.93776095,0.91408885,0.8872652,0.85322744,0.80538535,0.7332337,0.5449648,0.46026778,0.23031746,0.13801959,0.11648678,0.055220157,0.03440016,0.023523455,0.018676825,0.016206998,0.014237792,0.011983363,0.010462387,0.008366806,0]

# Consensus average plot for size 25:
p_25 = [0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.085,0.09,0.095,0.1,0.105,0.15,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1]
consensus_25 = [0.97952217,0.9594635,0.9379996,0.9151024,0.88625824,0.8511523,0.80691606,0.7002577,0.6193401,0.499606,0.3657211,0.25839153,0.28423724,0.09244903,0.071792044,0.047768045,0.038774006,0.031522974,0.0282014,0.024562448,0.021064267,0.016661948,0.0047308938]
consensus_stdevs_25 = [0.008458737,0.011493902,0.0146714505,0.017803775,0.022987356,0.029941112,0.043862704,0.105391875,0.17202699,0.204369,0.19584435,0.15817301,0.16293693,0.068958595,0.052674934,0.03682964,0.02942822,0.024028515,0.021065818,0.018493624,0.01573715,0.012713063,0.003396387]

# Consensus average plot for size 50:
p_50 = [0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.085,0.09,0.095,0.1,0.105,0.15,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1]
consensus_50 = [0.9799203,0.95953494,0.93776095,0.91408885,0.8872652,0.85322744,0.80538535,0.7332337,0.5449648,0.46026778,0.23031746,0.13801959,0.11648678,0.055220157,0.03440016,0.023523455,0.018676825,0.016206998,0.014237792,0.011983363,0.010462387,0.008366806,0]
consensus_stdevs_50 = [0.0038895935,0.0056787706,0.007290195,0.009221288,0.011499136,0.015893854,0.024856968,0.033144232,0.18509808,0.17870894,0.11500757,0.08903048,0.077264026,0.037488755,0.025733503,0.018112784,0.014279294,0.012159403,0.010601777,0.009073218,0.007914889,0.0064335815,0]

# Consensus & Susceptibility average plot for size 75:
p_75 = [0.015,0.04,0.07,0.08,0.09,0.1,0.125,0.15,0.2,0.3,0.5,0.9]
consensus_75 = [0.96984476,0.91415626,0.79953164,0.7169498,0.31710654,0.06527594,0.050682236,0.03281317,0.022705538,0.016086845,0.010787425,0.0056164055]
consensus_stdevs_75 = [0.0033049008,0.0061826836,0.019367028,0.031995386,0.099527605,0.047714207,0.038633645,0.024224797,0.016430086,0.011997942,0.008207326,0.004267586]

# Consensus & Susceptibility average plot for size 100:
p_100 = [0.015,0.04,0.07,0.08,0.09,0.1,0.125,0.15,0.2,0.3,0.5,0.9]
consensus_100 = [0.12255249,0.9139356,0.029140132,0.7153249,0.1353667,0.06580588,0.033012178,0.023355609,0.017382924,0.011729694,0.0081039,0.004194521]
consensus_stdevs_100 = [0.008822599,0.004543773,0.018674452,0.025813816,0.097864956,0.04415612,0.027376072,0.016965484,0.013086991,0.008813695,0.006054682,0.0031957973]

# Plot with discrete points (marker='o') connected by lines (-)
plt.errorbar(p_25, consensus_25, yerr=consensus_stdevs_25, fmt='o', capsize=5,
             capthick=0.7, elinewidth=0.7, alpha=0.8, zorder=1, color='tab:blue')
plt.plot(p_25, consensus_25, marker='o', linestyle='-', color='tab:blue', label=r"$N = 25$", linewidth=0.8, zorder=2)

plt.errorbar(p_50, consensus_50, yerr=consensus_stdevs_50, fmt='o', capsize=5, capthick=0.7, elinewidth=0.7, alpha=0.8, zorder=1, color='tab:orange')
plt.plot(p_50, consensus_50, marker='o', linestyle='-',  label=r"$N = 50$", linewidth=0.8, zorder=2, color='tab:orange')

plt.errorbar(p_75, consensus_75, yerr=consensus_stdevs_75, fmt='o', capsize=5, capthick=0.7, elinewidth=0.7, alpha=0.8, zorder=1,  color='tab:green')
plt.plot(p_75, consensus_75, marker='o', linestyle='-', label=r"$N = 75$", linewidth=0.8, zorder=2, color='tab:green')

plt.errorbar(p_100, consensus_100, yerr=consensus_stdevs_100, fmt='o', capsize=5, capthick=0.7, elinewidth=0.7, alpha=0.8, zorder=1, color='tab:red')
plt.plot(p_100, consensus_100, marker='o', linestyle='-', label=r"$N = 100$", linewidth=0.8, zorder=2, color='tab:red')

plt.ylabel("Promedio de consenso en estacionario")
#plt.title("Promedio de consenso en estacionario")

# Labels and title
plt.xlabel("p")
plt.legend(fontsize=12, loc="upper right")
#plt.legend(fontsize=20, loc="upper right", bbox_to_anchor=(1.0, 0.9))
plt.grid(True)
plt.tight_layout()
plt.show()
